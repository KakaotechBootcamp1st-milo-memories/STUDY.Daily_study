# FetchAPI

FetchAPI는 XMLHttpRequest의 복잡성을 해결하기 위해 등장한 웹 API로 더 단순하고 유연한 방식으로 HTTP 요청을 처리할 수 있게 한다.

AJAX 요청의 간편화를 위해 설계되었음

> HTTP란?
웹 브라우저와 서버 간 통신을 위한 프로토콜
- 주요 특징
무상태성 : 이전 상태를 저장하지 않고 각 요청을 독립적으로 처리함
상태 코드 : 상태코드를 사용하여 요청 성공 여부를 나타냄
헤더 : HTTP 요청과 응답은 헤더를 사용하여 추가적인 정보를 전송할 수 있다. 예를 들어 conternt-type, authorization, accept등의 데이터 타입 등을 지정하는데 사용한다.
본문(Body) aucrkwl HTTP메소드는 요청 본문에 데이터를 담아 서버로 전송헐 수 있도 데이터는 일반적으로 JSON형식으로 전송된다.
> 

## XMLHttpRequest

웹 앱에서 서버와 비동기 통신을 위해 사용되는 JS API

### XMLHttpRequest의 복잡성

상태 관리 : 응답에 대한 처리는 별도의 이벤트 핸들러로 관리

비동기 처리 : 이벤트 핸들러에 콜백 함수를 사용하여야 했고 비동기적으로 요청을 처리하게 되며 콜백 지옥 문제 발생 가능

요청 설정 : HTTP 요청이 세부 설정에 따라 복잡하게 처리

비직관적인 요청 설정

## Ajax

비동기적 웹 앱 개발을 위한 기법으로  XMLHttpRequest 또는 Fetch API를 사용하여 클라이언트와 서버 간 동적으로 데이터를 교환하는 기술

### 특징

- 비동기 통신 : 페이지 새로고침 없이 데이터를 받아오거나 전송 가능
- JSON, XML 데이터 처리

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/0ee43fab-2947-49b1-b42b-cf1eb07e56bc/48387235-b8f6-4a82-915f-d2008175faa7/Untitled.png)

### 사용법

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/0ee43fab-2947-49b1-b42b-cf1eb07e56bc/731a8a16-5a96-4a75-a36c-3ab55b5fa303/Untitled.png)

### Content-type

HTTP 헤더의 일종으로 요청, 응답 메시지 본문의 미디어 타입 지정

- 종류
    - application/json
    - text
    - multipart/form-data : 여러 종류의 데이터와 파일을 동시에 서버로 전송 가능, 각 필드가 별도의 파트로 구분, 파일 업로드에 적합하며 대용량 데이터나 다양한 형식의 데이터 사용에 적합
    - application/x-www-form-urlencoded : 폼 데이터를 URL 쿼리 문자열 형태로 서버에 전송, 주로 작은 데이터나 텍스트를 전송할 떄 사용되며 파일 업로드를 지원하지 않고 텍스트만 전송 가능, Key-value형식으로 인코딩

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/0ee43fab-2947-49b1-b42b-cf1eb07e56bc/bd696255-1d7a-42d3-bcf8-399aad3df0b8/Untitled.png)

## Fetch API의 주요 메소드

- GET
- POST
- PUT
- DELETE
- PATCH
- OPTIONS : 서버가 지원하는 HTTP 메소드 확인
- HEAD : GET과 유사하지만 응답 본문을 반환하지 않고 헤더만 반환

### 주의 : HTTP Method는 통신 규약 중 하나

HTTP 메소드와 실제 동작이 반드시 같다는 것을 동작하지 않고 서버에서 그 요청을 어떻게 처리할지는 거버의 구현에 따라 다를 수 있다.

## 에러 처리 및 디버깅

### 개발자 도구를 통한 Fetch 과정 확인

1. 개발자 도구에서 네트워크 탬 열기
2. Fetch/XHR 태그 선택
    - 전체 통신 목록에서 Fetch/XHR 항목만 표시되도록 필터링 설정
3. 확인하고 싶은 항목 선택
    - 요청이 성공하면 JSON 데이터를 포함한 응답을 확인할 수 있고 요청 실패 시 오류 메시지와 디버깅을 수행할 수 있음

### Promise에서 에러 처리

- Fetch API는 Promise를 반환하므로 then()과 catch()를 사용하여 비동기 요청을 처리
- 요청이 성공하면 then()블록에서 데이터를 처리하고 요청이 실패하면 catch()블록에서 에러를 처리한다.

### 에러 처리를 위한 방법

1. 콘솔에 로깅(간단하지만 권장하지 않음
    - 개발자 도구 콘솔을 사용하여 발생한 에러 기록
    - 운영 환경에서는 에러 처리를 하지 않는 것과 같음
2. 경고창 또는 팝업
    - alert() 함수를 사용하여 경고 메시지 표시
    - 사용자에게 에러 상황을 알리는데 유용함
3. 오류 페이지 보여주기
    - 심각한 오류가 발생했을 때 브라우저가 사용자에게 오류 페이지를 보여줄 수 있음
    - 오류 페이지 내용은 HTTP 상태 코드에 따라 다르게 표시
    - 사용자 경험을 향상시키고 문제를 원활하게 해결할 수 있도록 도와줌

### API 플랫폼을 통해 디버깅

- 간편한 API 요청 생성
- 실시간 요청 모니터링
- 풍부한 테스트 환경
- 다양한 환경 설정
- 강력한 디버깅 및 로깅

# Rest API와 GraphQL

## REST API(Representational State Transfer API)

자원을 이름으로 구분하여 해당 자원의 상태를 주고받는 모든 것을 의미

자원 중심 : 모든 자원에 고유하고 명확한 식별자가 있고 HTTP 메소드를 사용하여 자원에 대한 행위를 정의

행위 표현 : HTTP 메소드를 통해 자원에 대한 행위를 정의하며 각 메소드는 명확한 의미를 가진다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/0ee43fab-2947-49b1-b42b-cf1eb07e56bc/53976bad-3f42-49df-a9f3-c6574828b6e1/Untitled.png)

### 단점

- 표준화의 한계 : 웹 기술에 의존하지만 특정 구현에서는 표준이나 가이드라인이 부족하여 일관성이 떨어질 수 있다.
- 확장성의 한계 : 자원과 행위 별로 URI가 분리되어 자원의 수가 증가할수록 관리해야하는 URI 수도 증가하여 유지보수가 어려워질 수 있음
- 유연성 부족 : HTTP 메소드 종류가 제한적이어서 모든 앱 제한사항을 충족시키기 어려울 수 있음

## GraphQL

페이스북에서 개발한 쿼리 언어로 클라이언트가 원하는 데이터를 요청할 수 있는 강력한 API 질의 언어

- 유연한 데이터 요청 : 필요한 데이터를 직접 지정할 수 있게 해줌
- 단일 엔드포인트 : 클라이언트는 하나의 엔드포인트에서 모든 데이터 요청을 처리할 수 있음. 각 요청은 복잡한 데이터 구조에 맞게 설계
- 실시간 데이터 지원 : 실시간 데이터를 처리할 수 있는 Subscription을 지원. 이를 통해 실시간 업데이트가 필요할 때 사용 가능

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/0ee43fab-2947-49b1-b42b-cf1eb07e56bc/874e28be-fee7-460f-bb19-89516e80b79e/Untitled.png)

### 단점

- 데이터 노출 위험 : 클라이언트가 데이터를 직정 지정하으모 잘못된 설정으로 인해 민감한 데이터가 노출될 수 있음
- 쿼리 폭탄 : 복잡하고 대량의 데이터를 한 번에 요청할 때 쿼리를 이용하여 서버에 과도한 부하를 줄 수 있음
- 보안 취약점 : GraphQL 쿼리의 동작성과 유연성 때문에 잘못된 설정이나 취약점이 존재할 가능성이 높음

# 공개 API 사용

1. API 검생 및 선택
- 원하는 기능 또는 데이터를 제공하는 공개 API를 검색 엔진이나 API 집약 사이트를 이용하여 찾음 → 공공 데이터 포탈 등
- 지도 데이터, 날씨 정보, 금융 데이터, 소셜 미디어 데이터 등 다양한 분야의 API가 존재
1. API 문서 확인
- API 공식 문서를 찾아 API 사용 방법, 엔드 포인트 URL, 요청 및 응답 형식, 인증 방법 등을 확인
1. 인증 획득
- API를 사용하기 위해 필요한 인증 정보(API키, OAuth 토큰 등)를 발급 받음
- 인증 정보는 API를 안전하게 사용하고 API 제공자가 사용량을 추적하고 관리할 수 있도록 도와줌
1. API 테스트
- API를 호출하여 실제 데이터를 가져오는 테스트 진행 → Swagger, Postman
- API가 응답하는 데이터 형식과 내용을 확인하고 필요에 따라 데이터 가공 방법 계획
- 개발자 도구나 API 클라이언트를 사용하여 테스트하는 것이 좋음
1. 데이터 처리 및 통합
- 받아온 데이터를 앱에서 필요한 형태로 처리하고 uI에 표시하거나 다른 시스템에 통합
- 데이터를 실시간으로 업데이트하거나 일정 주기로 호출하여 최신 정보를 유지하는 방법을 구현

### 주의 사항

- 인증과 보안
    - API 키가 공개되지 않도록 보호해야함, 하드 코딩하지 않고 환경 변수나 안전한 저장소에 저장
    - HTTPS를 사용하여 정보 유출에 대한 보호
- 성능  최적화
    - 불필요한 요청을 줄이고 캐싱을 활용하여 데이터를 효율적으로 관리
    - 비동기 방식으로 API 요청을 처리하여 앱 응답성을 유지
- 문서와 업데이트
    - API 제공자가 제공하는 문서(엔드포인트, 요청 형식, 응답 예시 등)를 자세히 분석하고 이해해야 함
    - API가 변경될 수 있으므로 업데이트 사항과 변화를 모니터링
- 오류 처리와 디버깅
    - 사용자에게 이해하기 쉬운 메시지를 제공하기 위해 적절한 에러 핸들링 구현
    - 개발 중에는 개발자 도구를 이용하여 API 요청과 응답을 모니터링하고 디버깅하는 것이 좋음

# 질문

- 카카오 소셜 로그인을 구현했을 때 로그인 의존성을 카카오에 넘겨준다고 생각하는데 카카오 서버가 다운되었을 때 후속조치?
    - 카카오 서버 문제인지 자사 서버 문제인지 확인
    - 해당 경우에는 사실 문제를 해결하기 전까지 로그인이 어려움
    - OAuth 서버가 죽으면 자사 서버에서 할 수 있는 일이 많지 않음
    - 신뢰성이 높은 OAuth Provider를 사용하자!
- GraphQL도 URI에 쿼리문을 담아서 데이터를 요청하는 방식으로 사용하는건지?
    - URI에는 GraphQL의 엔드포인트가 담겨있고 쿼리문은 body에 담겨있다.
    - GraphQL의 기능을 담은 라이브러리가 있으므로 사용 추천
    - GraphQL도 HTTP에 대한 기능을 사용함
- GraphQL은 HTTP 메소드를 따로 지정해주지 않아도 되는지?
    - 라이브러리들을 사용해서 HTTP 메소드를 따로 지정해주지 않아도 됨
-
